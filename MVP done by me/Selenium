import pandas as pd
from selenium import webdriver
from selenium.webdriver.chrome.options import Options

def read_excel_file(file_path):
    df = pd.read_excel(file_path)
    return df

def check_email_phone_on_link(email, phone, source_link, headers):
    options = Options()
    options.add_argument("--headless")
    options.add_argument("--disable-gpu")
    options.add_argument("--disable-dev-shm-usage")
    options.add_argument("--disable-extensions")
    options.add_argument("--no-sandbox")
    options.add_argument("--disable-features=VizDisplayCompositor")
    chrome_path = "C:\Program Files\Google\Chrome\Application\chrome.exe"
    options.binary_location = chrome_path
    driver = webdriver.Chrome(chrome_options=options)
    driver.get(source_link)
    email_found = False
    phone_found = False
    if email in driver.page_source:
        email_found = True
    if phone in driver.page_source:
        phone_found = True
    driver.close()
    if email_found and phone_found:
        return True
    else:
        return False

df = read_excel_file("test.xlsx")
for index, row in df.iterrows():
    email = row["email"]
    phone = row["phone"]
    source_link = row["source_link"]
    headers = {"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.82 Safari/537.36"}
    if check_email_phone_on_link(email, phone, source_link, headers):
        print("Email and phone found on:", source_link)
    else:
        print("Email and phone not found on:", source_link)
